---
title: 主机架构&蜜罐识别&WAF识别&端口扫描
published: 2025-10-08
description: Web应用端口扫描识别、蜜罐特征识别，以及蜜罐使用案例。
tags: [Web,信息打点]
category: 网络安全
draft: false
---

# 主机架构&蜜罐识别&WAF识别&端口扫描&协议识别&服务安全

## 知识补充

开发语言：PHP、JAVA、Ruby、Python、C#，JS等。

> 中间件：
>
> **Web服务器：Apache、Nginx、IIS、lighttpd等。**
>
> **应用服务器：Tomcat、Jboss、Weblogic、Websphere等。**

数据库类型：Mysql、SqlServer、Oracle、Redis、MongoDB等。

操作系统信息：Linux、windows等。

应用服务信息：FTP、SSH、RDP、SMB、SMTP、LDAP、Rsync等

CDN信息：帝联、Cloudflare、网宿、七牛云、阿里云等。

WAF信息：创宇盾、宝塔、ModSecurity、玄武盾、OpenRASP等。

蜜罐信息：HFish、TeaPot、T-Pot、Glastopf等。

其他组件信息:fastjson、shiro、log4j、OA办公等。

## 端口识别

| **端口**                         | **服务**              | **渗透用途**                                                 |
| -------------------------------- | --------------------- | ------------------------------------------------------------ |
| tcp20,21                         | FTP                   | 允许匿名的上传下载,爆破,嗅探,win提权,远程执行(proftpd1.3.5),各类后门(proftpd,vsftp2.3.4) |
| tcp22                            | SSH                   | 可根据已搜集到的信息尝试爆破,v1版本可中间人,ssh隧道及内网代理转发,文件传输等等 |
| tcp23                            | Telnet                | 爆破,嗅探,一般常用于路由,交换登陆,可尝试弱口令               |
| tcp25                            | SMTP                  | 邮件伪造,vrfy/expn查询邮件用户信息,可使用smtp-user-enum工具来自动跑 |
| tcp/udp53                        | DNS                   | 允许区域传送,dns劫持,缓存投毒,欺骗以及各种基于dns隧道的远控  |
| tcp/udp69                        | TFTP                  | 尝试下载目标及其的各类重要配置文件                           |
| tcp80-89,443,8440-8450,8080-8089 | 各种常用的Web服务端口 | 可尝试经典的topn,vpn,owa,webmail,目标oa,各类Java控制台,各类服务器Web管理面板,各类Web中间件漏洞利用,各类Web框架漏洞利用等等…… |
| tcp110                           | POP3                  | 可尝试爆破,嗅探                                              |
| tcp111,2049                      | NFS                   | 权限配置不当                                                 |
| tcp137,139,445                   | Samba                 | 可尝试爆破以及smb自身的各种远程执行类漏洞利用,如,ms08-067,ms17-010,嗅探等…… |
| tcp143                           | IMAP                  | 可尝试爆破                                                   |
| udp161                           | SNMP                  | 爆破默认团队字符串,搜集目标内网信息                          |
| tcp389                           | LDAP                  | ldap注入,允许匿名访问,弱口令                                 |
| tcp512,513,514                   | Linuxrexec            | 可爆破,rlogin登陆                                            |
| tcp873                           | Rsync                 | 匿名访问,文件上传                                            |
| tcp1194                          | OpenVPN               | 想办法钓VPN账号,进内网                                       |
| tcp1352                          | Lotus                 | 弱口令,信息泄漏,爆破                                         |
| tcp1433                          | SQLServer             | 注入,提权,sa弱口令,爆破                                      |
| tcp1521                          | Oracle                | tns爆破,注入,弹shell…                                        |
| tcp1500                          | ISPmanager            | 弱口令                                                       |
| tcp1723                          | PPTP                  | 爆破,想办法钓VPN账号,进内网                                  |
| tcp2082,2083                     | cPanel                | 弱口令                                                       |
| tcp2181                          | ZooKeeper             | 未授权访问                                                   |
| tcp2601,2604                     | Zebra                 | 默认密码zerbra                                               |
| tcp3128                          | Squid                 | 弱口令                                                       |
| tcp3312,3311                     | kangle                | 弱口令                                                       |
| tcp3306                          | MySQL                 | 注入,提权,爆破                                               |
| tcp3389                          | Windowsrdp            | shift后门[需要03以下的系统],爆破,ms12-020                    |
| tcp3690                          | SVN                   | svn泄露,未授权访问                                           |
| tcp4848                          | GlassFish             | 弱口令                                                       |
| tcp5000                          | Sybase/DB2            | 爆破,注入                                                    |
| tcp5432                          | PostgreSQL            | 爆破,注入,弱口令                                             |
| tcp5900,5901,5902                | VNC                   | 弱口令爆破                                                   |
| tcp5984                          | CouchDB               | 未授权导致的任意指令执行                                     |
| tcp6379                          | Redis                 | 可尝试未授权访问,弱口令爆破                                  |
| tcp7001,7002                     | WebLogic              | Java反序列化,弱口令                                          |
| tcp7778                          | Kloxo                 | 主机面板登录                                                 |
| tcp8000                          | Ajenti                | 弱口令                                                       |
| tcp8009                          | tomcatAjp             | Tomcat-Ajp协议漏洞                                           |
| tcp8443                          | Plesk                 | 弱口令                                                       |
| tcp8069                          | Zabbix                | 远程执行,SQL注入                                             |
| tcp8080-8089                     | Jenkins,JBoss         | 反序列化,控制台弱口令                                        |
| tcp9080-9081,9090                | WebSphere             | Java反序列化/弱口令                                          |
| tcp9200,9300                     | ElasticSearch         | 远程执行                                                     |
| tcp11211                         | Memcached             | 未授权访问                                                   |
| tcp27017,27018                   | MongoDB               | 爆破,未授权访问                                              |
| tcp50070,50030                   | Hadoop                | 默认端口未授权访问                                           |

## 蜜罐搜索语法表

| 蜜罐                    | Quake  系统搜索语法           |
| ----------------------- | ----------------------------- |
| STRUTSHONEYPOT          | app:"StrutsHoneypot"          |
| CONPOT HTTP 蜜罐        | app:"Conpot Http  蜜罐"       |
| CONPOT MODBUS 蜜罐      | app:"Conpot modbus  蜜罐"     |
| CONPOT S7 蜜罐          | app:"Conpot s7 蜜罐"          |
| KIPPO 蜜罐              | app:"kippo 蜜罐"              |
| HONEYPY HTTP 蜜罐       | app:"Honeypy Http  蜜罐"      |
| HONEYPY ES 蜜罐         | app:"Honeypy ES 蜜罐"         |
| AMUN IMAP 蜜罐          | app:"amun imap 蜜罐"          |
| AMUN HTTP 蜜罐          | app:"amun http 蜜罐"          |
| NEPENTHES NETBIOS  蜜罐 | app:"Nepenthes netbios 蜜罐"  |
| NEPENTHES FTP 蜜罐      | app:"Nepenthes FTP 蜜罐"      |
| SSHESAME SSH 蜜罐       | app:"sshesame ssh 蜜罐"       |
| OPENCANARY 蜜罐管理后台 | app:"opencanary 蜜罐管理后台" |
| DIONAEA SIPD 蜜罐       | app:"Dionaea sipd 蜜罐"       |
| DIONAEA SMBD 蜜罐       | app:"Dionaea smbd 蜜罐"       |
| DIONAEA HTTP 蜜罐       | app:"Dionaea Http 蜜罐"       |
| DIONAEA MSSQL 蜜罐      | app:"Dionaea MSSQL 蜜罐"      |
| DIONAEA FTP 蜜罐        | app:"Dionaea ftp 蜜罐"        |
| DIONAEA MEMCACHED 蜜罐  | app:"Dionaea Memcached 蜜罐"  |
| KOJONEY SSH 蜜罐        | app:"Kojoney SSH 蜜罐"        |
| WEBLOGIC 蜜罐           | app:"weblogic 蜜罐"           |
| MYSQL 蜜罐              | app:"MySQL 蜜罐"              |
| HFISH 蜜罐              | app:"HFish 蜜罐"              |
| HFISH 蜜罐管理后台      | app:"HFish 蜜罐管理后台"      |
| HONEYTHING 物联网蜜罐   | app:"honeything 物联网蜜罐"   |
| ELASTICSEARCH 蜜罐      | app:"elasticsearch 蜜罐"      |
| HOSTUS 蜜罐             | app:"HostUS 蜜罐"             |
| WHOISSCANME 蜜罐        | app:"whoisscanme 蜜罐"        |
| 未知蜜罐                | app:"未知蜜罐"                |
| COWRIE TELNETD 蜜罐     | app:"Cowrie telnetd 蜜罐"     |
| GLASTOPF 蜜罐           | app:"glastopf 蜜罐"           |

## 蜜罐特征信息表

| 蜜罐        | 协议      | 端口     | 请求数据 | 响应特征                                                     |
| ----------- | --------- | -------- | -------- | ------------------------------------------------------------ |
| whoisscanme | TCP       | ALL      | 空       | whoisscanme:https://github.com/bg6cq/whoisscanme             |
| Cowrie      | TELNET    | 23/23    | 空       | \xff\xfd\x1flogin:                                           |
| Amun        | IMAP      | 143      | \r\n\r\n | a001 OK LOGIN completed                                      |
| Dionaea     | FTP       | 21       | 空       | 220 Welcome to the ftp service\r\n                           |
| Dionaea     | MSSQL     | 1443     | 空       | \x04\x01\x00\x2b\x00\x00\x00\x00\x00\x00\x1a\x00\x06\x01\x00\x20\x00\x01\x02\x00\x21\x00\x01\x03\x00\x22\x00\x00\x04\x00\x22\x00\x01\xff\x08\x00\x02\x10\x00\x00\x02\x00\x00 |
| Kojoney     | SSH       | 22/22 22 | 空       | SSH-2.0-Twisted\r\n                                          |
| Nepenthes   | FTP       | 21       | 空       | —freeFTPd 1.0—warFTPd 1.65—\r\n                              |
| Nepenthes   | NETBIOS   | 2103     | 空       | \x82\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00 |
| Conpot      | S7        | 102      | 空       | Serial number of module: 88111222                            |
| Conpot      | MODBUS    | 502      | 空       | Device Identification: Siemens SIMATIC S7-200                |
| Dionaea     | Memcached | 11211    | 空       | version: “1.4.25” AND response:“pointer_size 64” AND response:“STAT rusage_user 0.550000” |
| Dionaea     | SIPD      | 5060     | 空       | SIP/2.0 200 OK\r\nContent-Length: 0\r\nVia: SIP/2.0/TCP nm;branch=foo\r\nFrom: sip:nm@nm;tag=root\r\nAccept: application/sdp\r\nTo: sip:nm2@nm2\r\nContact: sip:nm2@nm2\r\nCSeq: 42 OPTIONS\r\nAllow: REGISTER, OPTIONS, INVITE, CANCEL, BYE, ACK\r\nCall-ID: 50000\r\nAccept-Language: en\r\n\r\n |
| sshsame     | SSH       | 2022     | 空       | SSH-2.0-sshesame                                             |



## 识别-Web 服务器-请求返回包

## 识别-应用服务器-端口扫描技术 

## 识别-其他服务协议-端口扫描技术

- Web 中间件探针

- 应用中间件探针

- 数据库类型探针

- 其他服务协议探针

  端口扫描：Nmap（老牌经典）、Masscan（新星主动扫描）、网络空间fofa（被动搜集）。

  开放状态：Close、Open、Filtered（过滤，可能有防火墙等防护）。

  下载地址：

  https://nmap.org/download.html

  https://github.com/robertdavidgraham/masscan

  使用参考：

  Masscan：https://blog.csdn.net/qq_53079406/article/details/125266331

  Nmap：https://blog.csdn.net/qq_53079406/article/details/125263917 

  编译 masscan：https://www.cnblogs.com/lzy575566/p/15513726.html

  考虑：1、防火墙 2、内网环境

  内网环境可能出现情况：明明数据库端口开的，网站也能正常打开，但是你对目标进行端口扫描，发现数据库端口没有开放（排除防火墙问题，不是防火墙影响的）。

## Nmap扫描案例1

![](https://cdn.jsdelivr.net/gh/PWN022/0x00@main/NetSecurity/My_screenshot/15-01.png)

## 识别-WAF防火墙-看图&项目&指纹

学习WAF：对安全测试没有意义。

学习意义：如果有WAF会面临什么问题，我们可以选择性放弃，不继续猛攻，遇到这个只能绕过（但是只有极少数鸡肋WAF绕）。

1. WAF 解释：

   Web 应用防护系统（也称为：网站应用级入侵防御系统。英文：Web Application Firewall，简称：WAF）。

   利用国际上公认的一种说法：Web 应用防火墙是通过执行一系列针对 HTTP/HTTPS 的安全策略来专门为Web 应用提供保护的一款产品。

2. WAF 分类：

   云 WAF：百度安全宝、阿里云盾、长亭雷池，华为云，亚马逊云等。（中大型、比较有实力的黑灰产等预算充足利用较多）

   硬件 WAF：绿盟、安恒、深信服、知道创宇等公司商业产品。（zf、军x、xx单位、教育行业等利用较多）

   软件 WAF：宝塔，安全狗、D 盾等。（黑灰产等预算不高利用较多，此项有概率可绕过其他直接放弃）

   代码级 WAF：自己写的 waf 规则，防止出现注入等，一般是在代码里面写死的。

3. 识别看图：

   拦截页面，identywaf项目内置。

4. 识别项目：

   wafw00f：https://github.com/EnableSecurity/wafw00f

   identywaf：https://github.com/stamparm/identYwaf

   或者其他网络空间平台，比如FOFA、微步在线等。

## 识别-蜜罐平台-人工&网络空间&项目

### 蜜罐解释：

蜜罐是一种安全威胁的检测技术，其本质在于引诱和欺骗攻击者，并且通过记录攻击者的攻击日志来产生价值。 安全研究人员可以通过分析蜜罐的被攻击记录推测攻击者的意图和手段等信息。攻击方可以通过蜜罐识别技术来发现和规避蜜罐。因此，我们有必要站在红队攻击者的角度钻研蜜罐识别的方式方法。

**蓝队诱导红队来攻击，但可以浪费红队时间，然后分析红队攻击手法。**

### 蜜罐分类：

根据**蜜罐与攻击者之间进行的交互的程度**可以将蜜罐分为三类:低交互蜜罐、中交互蜜罐、高交互蜜罐。当然还可以根据**蜜罐模拟的目标**进行分类，比如：数据库蜜罐、工控蜜罐、物联网蜜罐、Web蜜罐等等。

### 蜜罐产品：

详情看蜜罐搜索语法表

### 识别原理：

https://mp.weixin.qq.com/s/jPz9hBmUypFyQlU27vglUg

### 识别技术：

- 测试

  大概了解组成功能等。

  Hfish：https://hfish.net/#/

- 项目

  项目识别：

  [Heimdallr浏览器插件](https://github.com/graynjo/Heimdallr)（不过容易误报，但是方便）

  [360quake专业工具](https://github.com/360quake/quake_rs)
  第一次用需要配置：（具体使用方法查其他的）
  quake.exe init apikey值
  用法：quake.exe honeypot 目标

- 人工判断

  端口多而有规律性

  Web访问协议就下载（用web访问其他端口协议就会出现下载）：

  > ssh mysql应用蜜罐 搞一个可以爆破的地方
  >
  > 爆破 蜜罐会记录攻击者的账号密码
  > 账号密码会采用web jsonp去传输（转发 跳转jsonp去传输）
  > 当你去web http去访问这个端口 采用协议去下载文件

  设备指纹分析（见蜜罐特征信息表）

# 蜜罐案例1

直接用Hfish进行演示，在本地的Centos中进行安装。

命令如下（以root权限）：

```shell
bash <(curl -sS -L https://hfish.net/webinstall.sh)
```

![](https://cdn.jsdelivr.net/gh/PWN022/0x00@main/NetSecurity/My_screenshot/15-02.png)

之后按照Hfish官方文档进行操作，我就把步骤直接贴到这里了：

完成后，点击进入自己的后台，点击环境管理处的节点管理，再展开即可查看开放的端口（还可以通过添加蜜罐服务来开放更多的端口），之后可以对开放的端口进行一个简单的测试：
在这里，我只进行了简单的8080端口的登录操作，以及使用nmap对该ip进行扫描，后台可以查看到此次的攻击行为。

```
登陆链接：https://[ip]:4433/web/
账号：admin
密码：HFish2021
```

![](https://cdn.jsdelivr.net/gh/PWN022/0x00@main/NetSecurity/My_screenshot/15-03.png)

![](https://cdn.jsdelivr.net/gh/PWN022/0x00@main/NetSecurity/My_screenshot/15-04.png)

![](https://cdn.jsdelivr.net/gh/PWN022/0x00@main/NetSecurity/My_screenshot/15-05.png)

![](https://cdn.jsdelivr.net/gh/PWN022/0x00@main/NetSecurity/My_screenshot/15-07.png)

![](https://cdn.jsdelivr.net/gh/PWN022/0x00@main/NetSecurity/My_screenshot/15-06.png)

